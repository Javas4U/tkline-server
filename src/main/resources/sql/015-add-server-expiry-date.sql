-- ============================================================================
-- 添加节点服务器到期时间字段
-- 功能分支: 015-add-server-expiry-date
-- 创建时间: 2026-01-23
-- ============================================================================

USE tkline;

-- 添加服务器到期时间字段到 node 表
ALTER TABLE `node`
ADD COLUMN `server_expiry_date` DATETIME DEFAULT NULL COMMENT '服务器到期时间'
AFTER `last_heartbeat_time`;

-- 添加索引以提高查询性能
ALTER TABLE `node`
ADD INDEX `idx_node_server_expiry_date` (`server_expiry_date`);

-- ============================================================================
-- 执行说明:
-- 1. 该字段用于标识服务器的到期时间
-- 2. 前端会根据该字段显示警告提示:
--    - 小于15天: 红色 error 级别警告
--    - 15-30天: 黄色 warning 级别警告
--    - 大于30天: 绿色正常显示
-- 3. 建议在测试环境先执行验证
-- 4. 生产环境执行前请备份数据库
-- ============================================================================
